<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trustworthy Product Reviews – Dashboard</title>
    <link rel="stylesheet" href="css/index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script>
        window.__SUPABASE_URL__ = 'https://yoeskespkkrctuxgezee.supabase.co';
        window.__SUPABASE_ANON_KEY__ = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlvZXNrZXNwa2tyY3R1eGdlemVlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1OTMyNzUsImV4cCI6MjA3NzE2OTI3NX0.FtDQiqVaFliz40lx8-w_p7E4EIBiX5SiRDdSPDQVY4o';
    </script>
</head>
<body data-page="app">
<header class="app-header">
    <div class="app-header__info">
        <h1>Trustworthy Product Reviews</h1>
        <p id="user-greeting">Loading profile…</p>
    </div>
    <nav class="app-header__actions">
        <div class="profile-dropdown">
            <button class="profile-button" id="profile-toggle">
                <span id="profile-name">Loading...</span>
                <span class="dropdown-arrow">▼</span>
            </button>
            <div class="profile-menu" id="profile-menu">
                <div class="profile-menu__header">
                    <h3 id="profile-menu-name">Loading...</h3>
                    <p id="profile-menu-email">Loading...</p>
                </div>
                <div class="profile-menu__content">
                    <h4>Account Settings</h4>
                    <div class="profile-menu__links">
                        <button class="link" id="change-display-name-link">Change Display Name</button>
                        <button class="link" id="change-password-link">Change Password</button>
                    </div>
                </div>
                <div class="profile-menu__footer">
                    <button class="button button--danger button--small" id="logout-button">Log out</button>
                </div>
            </div>
        </div>
    </nav>
</header>
<main class="dashboard">
    <section class="dashboard__sidebar">
        <article class="panel">
            <h2>Profile</h2>
            <div class="profile-section">
                <div class="profile-tabs">
                    <button class="profile-tab active" id="following-tab">Following</button>
                    <button class="profile-tab" id="followers-tab">Followers</button>
                    <button class="profile-tab" id="search-users-tab">Search</button>
                </div>
                
                <div class="profile-content" id="profile-content">
                    <div class="profile-list" id="following-list"></div>
                    <div class="profile-list hidden" id="followers-list"></div>
                    <div class="hidden" id="search-users-section">
                        <div class="search-users">
                            <input type="text" id="user-search-input" placeholder="Search by email or username..." class="search-input">
                            <div class="profile-list" id="search-results"></div>
                        </div>
                    </div>
                </div>
            </div>
        </article>
    </section>
    <section class="dashboard__content">
    <!--Products-->
    <div id="products-container" class="products-container">
    </div>
</section>
</main>
<!-- Account Settings Modals -->
<div class="modal" id="display-name-modal">
    <div class="modal__content">
        <div class="modal__header">
            <h3>Change Display Name</h3>
            <button class="modal__close" id="close-display-name-modal">&times;</button>
        </div>
        <form id="profile-form" class="modal__form" novalidate>
            <label class="auth__field">
                <span>Display name</span>
                <input type="text" id="profile-display-name" maxlength="80" placeholder="Display name">
            </label>
            <div class="modal__actions">
                <button type="button" class="button button--ghost" id="cancel-display-name">Cancel</button>
                <button type="submit" class="button">Save Changes</button>
            </div>
            <p class="auth__status" id="profile-status"></p>
        </form>
    </div>
</div>

<div class="modal" id="password-modal">
    <div class="modal__content">
        <div class="modal__header">
            <h3>Change Password</h3>
            <button class="modal__close" id="close-password-modal">&times;</button>
        </div>
        <form id="password-form" class="modal__form" novalidate>
            <label class="auth__field">
                <span>New password</span>
                <input type="password" id="profile-password" minlength="6" placeholder="New password">
            </label>
            <div class="modal__actions">
                <button type="button" class="button button--ghost" id="cancel-password">Cancel</button>
                <button type="submit" class="button">Update Password</button>
            </div>
            <p class="auth__status" id="password-status"></p>
        </form>
    </div>
</div>

<!-- User Profile Modal -->
<div class="modal" id="user-profile-modal">
    <div class="modal__content">
        <div class="modal__header">
            <h3 id="profile-modal-name">User Profile</h3>
            <button class="modal__close" id="close-user-profile-modal">&times;</button>
        </div>
        <div class="modal__body" id="user-profile-modal-body">
            <div class="profile-stats">
                <div class="stat">
                    <span class="stat-label">Following</span>
                    <span class="stat-value" id="profile-following-count">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Followers</span>
                    <span class="stat-value" id="profile-followers-count">0</span>
                </div>
            </div>
            <button class="button" id="toggle-follow-button" style="width: 100%; margin-top: 1rem;">Follow</button>
        </div>
    </div>
</div>

<footer class="footer">&copy; <span id="year"></span> Trustworthy Product Reviews.</footer>

<script type="module" src="js/auth.js"></script>
<script type="module" src="js/app.js"></script>
<script type="module" src="js/profile.js"></script>
</body>
</html>
